# Architectural Smells (Ground Truth)

| Smell | Primary Service / Module | Code File Path (if applicable) | Code Line(s) | Labeling justification in details |
| --- | --- | --- | --- | --- |
| Insufficient Modularization | order-service | `services/order/src/main/java/com/elsebaey/ecommerce/order/OrderController.java`; `services/order/src/main/java/com/elsebaey/ecommerce/orderline/OrderLineController.java`; `services/order/src/main/java/com/elsebaey/ecommerce/orderline/OrderLineService.java` | OrderController:L11-L31; OrderLineController:L13-L21; OrderLineService:L12-L24 | The order service publishes REST handlers for both order management and order-line lookups while persisting order-line records directly, so cart-line responsibilities are embedded instead of residing in a dedicated module. |
| Unstable Dependency | order-service | `services/order/src/main/java/com/elsebaey/ecommerce/order/OrderService.java`; `services/order/src/main/java/com/elsebaey/ecommerce/customer/CustomerClient.java`; `services/order/src/main/java/com/elsebaey/ecommerce/product/ProductClient.java`; `services/order/src/main/java/com/elsebaey/ecommerce/payment/PaymentClient.java` | OrderService:L23-L68; CustomerClient:L9-L16; ProductClient:L23-L45; PaymentClient:L7-L14 | Order creation synchronously invokes customer, product, and payment services with Feign/RestTemplate calls that lack fallbacks or circuit breakers, so any downstream instability immediately fails the orchestrated workflow. |
| Greedy Service | order-service | `services/order/src/main/java/com/elsebaey/ecommerce/order/OrderService.java` | OrderService:L23-L69 | `OrderService.createOrder` coordinates customer validation, product reservation, order persistence, order-line creation, payment initiation, and confirmation publishing in one transaction script instead of delegating those concerns to specialized collaborators. |
| Hub-like Services | order-service | `services/order/src/main/java/com/elsebaey/ecommerce/order/OrderService.java`; `services/order/src/main/java/com/elsebaey/ecommerce/kafka/OrderProducer.java`; `services/order/src/main/java/com/elsebaey/ecommerce/customer/CustomerClient.java`; `services/order/src/main/java/com/elsebaey/ecommerce/product/ProductClient.java`; `services/order/src/main/java/com/elsebaey/ecommerce/payment/PaymentClient.java` | OrderService:L23-L68; OrderProducer:L16-L25; CustomerClient:L9-L16; ProductClient:L23-L45; PaymentClient:L7-L14 | The order service becomes a communication hub that synchronously talks to customer, product, and payment services and then emits Kafka events, concentrating cross-bounded-context traffic in a single component. |
| Shared Persistency | order, product, payment services | `services/config-server/src/main/resources/configurations/order-service.yml`; `services/config-server/src/main/resources/configurations/product-service.yml`; `services/config-server/src/main/resources/configurations/payment-service.yml` | order-service.yml:L3-L6; product-service.yml:L3-L6; payment-service.yml:L9-L12 | Multiple domain services are configured to connect to the same PostgreSQL instance at `localhost:5432` with shared credentials, so persistence remains coupled at the infrastructure level despite separate schemas. |
| Broken Modularization | payment-service | `services/payment/src/main/java/com/elsebaey/ecommerce/payment/PaymentService.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/notification/NotificationProducer.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/notification/PaymentNotificationRequest.java`; `services/notification/src/main/java/com/elsebaey/ecommerce/kafka/NotificationConsumer.java` | PaymentService:L12-L27; NotificationProducer:L1-L26; PaymentNotificationRequest:L1-L14; NotificationConsumer:L24-L64 | Payment logic embeds notification-domain packages and message shapes, while the notification service separately consumes the same events, fragmenting the notification responsibility across services instead of keeping it modularized. |
| Unnecessary Abstraction | order-service | `services/order/src/main/java/com/elsebaey/ecommerce/product/ProductClient.java` | ProductClient:L21-L45 | A bespoke `ProductClient` wraps RestTemplate exchanges and manual header construction around the product `/purchase` endpoint even though the project already uses declarative Feign clients, adding an extra abstraction layer that mirrors the downstream API without reducing coupling. |
| Cyclic Dependency | product-service | `services/product/src/main/java/com/elsebaey/ecommerce/product/Product.java`; `services/product/src/main/java/com/elsebaey/ecommerce/category/Category.java` | Product:L3-L27; Category:L3-L24 | The product aggregate holds a JPA `@ManyToOne` reference to `Category` while `Category` maintains a `@OneToMany` collection of `Product`, creating a bidirectional dependency cycle that tangles the two modules. |
| ESB Usage | order-service, payment-service, notification-service | `services/order/src/main/java/com/elsebaey/ecommerce/kafka/OrderProducer.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/notification/NotificationProducer.java`; `services/notification/src/main/java/com/elsebaey/ecommerce/kafka/NotificationConsumer.java` | OrderProducer:L16-L25; NotificationProducer:L16-L25; NotificationConsumer:L27-L63 | Order and payment services publish domain events onto shared Kafka topics that the notification service consumes to drive email side effects, effectively routing multiple bounded contexts through a centralized messaging bus. |
| Service Intimacy | order-service, payment-service | `services/order/src/main/java/com/elsebaey/ecommerce/payment/PaymentRequest.java`; `services/order/src/main/java/com/elsebaey/ecommerce/customer/CustomerResponse.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/payment/PaymentService.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/payment/PaymentRequest.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/payment/Customer.java` | order-service PaymentRequest:L8-L13; CustomerResponse:L3-L8; payment-service PaymentService:L16-L26; payment-service PaymentRequest:L5-L11; Customer:L7-L16 | The order service forwards full customer identity details inside payment requests, and the payment service reaches into those nested fields, forcing both services to share and understand each otherâ€™s internal customer representation. |
