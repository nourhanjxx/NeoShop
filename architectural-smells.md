# Architectural Smell Validation (Ground Truth)

| Smell | Primary Service / Module | Detected? | Code File Path (if applicable) | Code Line(s) | Labeling justification in details |
| --- | --- | --- | --- | --- | --- |
| Insufficient Modularization | product-service | No | `services/product/src/main/java/com/elsebaey/ecommerce/product/ProductController.java`; `services/product/src/main/java/com/elsebaey/ecommerce/product/ProductService.java`; `services/product/src/main/java/com/elsebaey/ecommerce/product/ProductRepository.java` | ProductController:L1-L44; ProductService:L1-L66; ProductRepository:L1-L9 | The product module only exposes catalog CRUD and stock reservation endpoints over `/api/v1/products`, and every handler delegates to a single repository without bundling unrelated subdomains (for example, there is no category controller or pricing workflow), so the module stays within its bounded context. |
| Greedy Service | customer-service | No | `services/customer/src/main/java/com/elsebaey/ecommerce/customer/CustomerController.java`; `services/customer/src/main/java/com/elsebaey/ecommerce/customer/CustomerService.java` | CustomerController:L1-L52; CustomerService:L1-L65 | Customer operations are limited to Mongo-backed CRUD and simple field merges; the service never orchestrates cross-context logic or downstream calls, so it does not accumulate multiple responsibilities. |
| Greedy Service | notification-service | Yes | `services/notification/src/main/java/com/elsebaey/ecommerce/kafka/NotificationConsumer.java`; `services/notification/src/main/java/com/elsebaey/ecommerce/email/EmailService.java` | NotificationConsumer:L1-L66; EmailService:L1-L100 | The notification service consumes payment and order Kafka topics, persists notification entities, and directly drives SMTP email dispatch, centralizing message handling, persistence, and delivery concerns in one module. |
| Greedy Service | order-service | Yes | `services/order/src/main/java/com/elsebaey/ecommerce/order/OrderService.java` | OrderService:L1-L83 | `OrderService.createOrder` coordinates customer lookup, product reservation, order persistence, order-line creation, payment capture, and Kafka confirmations in one transaction script, spanning several bounded contexts. |
| Greedy Service | payment-service | Yes | `services/payment/src/main/java/com/elsebaey/ecommerce/payment/PaymentService.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/notification/NotificationProducer.java` | PaymentService:L1-L27; NotificationProducer:L1-L24 | Payment creation both persists the transaction and constructs notification payloads before sending them over Kafka, so the payment module owns payment and notification orchestration responsibilities simultaneously. |
| Greedy Service | product-service | No | `services/product/src/main/java/com/elsebaey/ecommerce/product/ProductService.java` | ProductService:L1-L66 | ProductService mediates repository calls to create products, reserve inventory, and map DTOs; it never calls external services or coordinates other bounded contexts, so it does not behave as a greedy orchestrator. |
| Unversioned API | api-gateway | No | `services/config-server/src/main/resources/configurations/gateway-service.yml` | gateway-service.yml:L1-L28 | Every Spring Cloud Gateway route is explicitly prefixed with `/api/v1/...`, so the gateway publishes only versioned HTTP entry points. |
| ESB Usage | api-gateway | No | `services/gateway/src/main/java/com/elsebaey/gateway/GatewayApplication.java`; `services/gateway/src/main/java/com/elsebaey/gateway/security/SecurityConfig.java`; `services/config-server/src/main/resources/configurations/gateway-service.yml` | GatewayApplication:L1-L11; SecurityConfig:L1-L24; gateway-service.yml:L1-L28 | The gateway module just boots Spring Cloud Gateway with security filters and static route definitions; it does not host message translators, orchestrations, or asynchronous mediation typical of an ESB. |
| Broken Modularization | product-service | No | `services/product/src/main/java/com/elsebaey/ecommerce/product/ProductService.java`; `services/product/pom.xml` | ProductService:L1-L66; pom.xml:L1-L133 | ProductService restricts itself to catalog persistence, and the Maven module only depends on Spring, JPA, validation, and observability starters—there are no foreign bounded-context packages or notification/email classes embedded here. |
| Cyclic Dependency | customer-service | No | `services/customer/src/main/java/com/elsebaey/ecommerce/customer/Customer.java`; `services/customer/src/main/java/com/elsebaey/ecommerce/customer/Address.java` | Customer:L1-L20; Address:L1-L17 | Customer embeds Address as a value object, but Address never references Customer, so the package graph remains acyclic. |
| Cyclic Dependency | order-service | Yes | `services/order/src/main/java/com/elsebaey/ecommerce/order/Order.java`; `services/order/src/main/java/com/elsebaey/ecommerce/orderline/OrderLine.java` | Order:L1-L40; OrderLine:L1-L24 | `Order` keeps a collection of `OrderLine` entities mapped by `order`, while each `OrderLine` holds a `ManyToOne` back to `Order`, forming a bidirectional dependency cycle between the two packages. |
| Cyclic Dependency | payment-service | Yes | `services/payment/src/main/java/com/elsebaey/ecommerce/payment/PaymentService.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/notification/NotificationProducer.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/notification/PaymentNotificationRequest.java`; `services/payment/src/main/java/com/elsebaey/ecommerce/payment/PaymentMethod.java` | PaymentService:L1-L30; NotificationProducer:L1-L24; PaymentNotificationRequest:L1-L15; PaymentMethod:L1-L9 | `PaymentService` imports the notification package to publish Kafka messages, while `PaymentNotificationRequest` in that package depends on the `PaymentMethod` enum from the payment package, so the module’s `payment` and `notification` packages depend on each other, forming a compile-time cycle. |
| Cyclic Dependency | product-service | Yes | `services/product/src/main/java/com/elsebaey/ecommerce/product/Product.java`; `services/product/src/main/java/com/elsebaey/ecommerce/category/Category.java` | Product:L1-L28; Category:L1-L24 | `Product` references `Category` via `@ManyToOne`, and `Category` maintains a `List<Product>` with `@OneToMany`, creating a bidirectional entity dependency within the module. |

## Double-check conclusions

- Re-ran a full scan across every service module (`customer`, `notification`, `order`, `payment`, `product`, `gateway`) and their supporting configs and build descriptors.
- The pass surfaced a previously overlooked package-level cycle in the payment service between `payment` classes and the in-module `notification` helpers; the table now records this smell with the supporting file paths.
- Verified that the remaining “No” entries genuinely lack the requested smells: the product module exposes only catalog CRUD and reservation handlers, the customer module performs straightforward Mongo CRUD merges, and the gateway configuration keeps all routes versioned without ESB-style mediation.
